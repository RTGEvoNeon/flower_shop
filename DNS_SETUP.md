# Инструкция по настройке DNS для эдемский-сад.рф

## ВАЖНО: Без настройки DNS невозможно получить SSL сертификат!

### IP адрес вашего сервера
```
185.11.135.11
```

### Домены для настройки
- **Кириллический**: эдемский-сад.рф
- **Punycode**: xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai

---

## Вариант 1: Настройка через панель регистратора

### Где настраивать DNS?
Зайдите в панель управления вашего регистратора доменов где вы зарегистрировали домен **эдемский-сад.рф** или **xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai**.

Популярные регистраторы:
- REG.RU - https://www.reg.ru/user/account/
- Timeweb - https://timeweb.com/ru/my/domains/
- Beget - https://cp.beget.com/
- Nic.ru - https://www.nic.ru/
- R01 - https://r01.ru/

### Что добавить?

В разделе управления DNS записями добавьте следующие **А-записи**:

| Тип | Имя (Host) | Значение (IP адрес) | TTL |
|-----|------------|---------------------|-----|
| A   | @ или пусто | 185.11.135.11 | 3600 |
| A   | www        | 185.11.135.11 | 3600 |

**Важно:**
- Некоторые регистраторы требуют вводить домен в punycode формате: `xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai`
- Символ `@` означает корневой домен (сам домен без www)
- TTL можно оставить по умолчанию (обычно 3600 секунд = 1 час)

---

## Вариант 2: Настройка через NS серверы (если используете сторонний DNS)

Если вы используете сторонний DNS сервис (Cloudflare, Yandex.Cloud DNS и т.д.):

1. Убедитесь что NS записи домена указывают на ваш DNS сервис
2. В панели DNS сервиса добавьте те же А-записи из таблицы выше

---

## Проверка настройки DNS

### Способ 1: Онлайн сервисы
- https://2ip.ru/whois/
- https://whatsmydns.net/
- https://dnschecker.org/

Введите: `xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai`

### Способ 2: Команда на сервере
```bash
# Проверка основного домена
host xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai 8.8.8.8

# Должно вернуть:
# xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai has address 185.11.135.11
```

---

## Время распространения DNS

- **Минимум**: 5-10 минут
- **Обычно**: 30-60 минут
- **Максимум**: до 24 часов (редко)

---

## После настройки DNS

Когда DNS будет настроен, запустите автоматический скрипт для получения SSL:

```bash
cd /var/www/html/flower_shop
./setup-new-domain.sh
```

Или выполните вручную:

```bash
# 1. Проверить DNS
host xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai 8.8.8.8

# 2. Получить SSL сертификат
docker-compose -f docker-compose.prod.yml run --rm certbot certonly \
    --webroot \
    --webroot-path=/var/www/certbot \
    --email admin@mindale.ru \
    --agree-tos \
    --no-eff-email \
    -d эдемский-сад.рф \
    -d www.эдемский-сад.рф \
    -d xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai \
    -d www.xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai

# 3. Применить финальную конфигурацию
cp docker/nginx/prod.conf.backup docker/nginx/prod.conf
docker exec laravel_nginx_prod nginx -s reload
```

---

## Текущий статус

✅ Сервер готов (185.11.135.11)
✅ Nginx настроен
✅ Временная конфигурация применена
✅ Docker контейнеры запущены
❌ **DNS не настроен - требуется ваше действие!**
⏳ SSL сертификат - ожидает настройки DNS

---

## Помощь

Если возникли проблемы:
1. Проверьте что вы вошли в правильный аккаунт регистратора
2. Убедитесь что домен не заблокирован
3. Проверьте что у вас есть права на управление DNS
4. Попробуйте использовать punycode формат: xn----7sbabdeflfh8aja4aj7ayg.xn--p1ai
